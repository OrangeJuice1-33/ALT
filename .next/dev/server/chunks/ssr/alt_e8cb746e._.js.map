{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/kartikarora/alt/src/app/add-venue/step-6-booking/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useMemo } from \"react\";\nimport { useRouter, useSearchParams } from \"next/navigation\";\nimport { format, addDays, eachDayOfInterval, isSameDay } from \"date-fns\";\n\nfunction dateToISO(d: Date) { return d.toISOString().slice(0,10); }\n\nexport default function Step6Booking() {\n  const router = useRouter();\n  const params = useSearchParams();\n  const listingId = params.get(\"id\"); // or passed via query\n  const service = params.get(\"service\"); // e.g., \"venue\" or \"dj\"\n\n  const today = new Date();\n  const [startDate, setStartDate] = useState<string>(dateToISO(today));\n  const [endDate, setEndDate] = useState<string>(dateToISO(addDays(today,1)));\n  const [excludeMode, setExcludeMode] = useState(false);\n  const [excludedDates, setExcludedDates] = useState<string[]>([]);\n\n  // pricing mode\n  const defaultUnit = service === \"venue\" ? \"night\" : \"gig\";\n  const [unit, setUnit] = useState<string>(defaultUnit);\n  const [pricePerUnit, setPricePerUnit] = useState<number>(5000); // sample default\n  const [priceSlider, setPriceSlider] = useState<number>(pricePerUnit);\n\n  // discounts list (local UI) — each item {min_units, percent}\n  const [discounts, setDiscounts] = useState<{min_units:number, percent:number}[]>([]);\n\n  // derived days between\n  const dateRangeDays = useMemo(() => {\n    const s = new Date(startDate);\n    const e = new Date(endDate);\n    if (s > e) return [];\n    return eachDayOfInterval({ start: s, end: e }).map(d => dateToISO(d));\n  }, [startDate, endDate]);\n\n  // effective units = dateRangeDays.length - excludedDates.length (for nights)\n  const effectiveUnits = Math.max(0, dateRangeDays.length - excludedDates.length);\n\n  // helper to toggle excluded date\n  function toggleExcluded(dateISO: string) {\n    setExcludedDates(prev => prev.some(d => d === dateISO) ? prev.filter(d=>d!==dateISO) : [...prev, dateISO]);\n  }\n\n  // discount editor\n  const [discUnits, setDiscUnits] = useState<number>(3);\n  const [discPercent, setDiscPercent] = useState<number>(5);\n\n  function addDiscount() {\n    setDiscounts(prev => [...prev, { min_units: discUnits, percent: discPercent }]);\n  }\n\n  // calculate applicable discount amount\n  function computeDiscount(subtotal:number) {\n    // choose the single best discount (largest percent) that meets min_units\n    const applicable = discounts.filter(d => effectiveUnits >= d.min_units);\n    if (applicable.length === 0) return 0;\n    const top = Math.max(...applicable.map(d => d.percent));\n    return (subtotal * top) / 100;\n  }\n\n  function handleNext() {\n    // basic validation\n    if (!startDate || !endDate) return alert(\"Choose start and end date.\");\n    if (new Date(startDate) > new Date(endDate)) return alert(\"Start date must be before end date.\");\n\n    // build booking object and go to summary page (redirect with query or create server record first)\n    const query = new URLSearchParams({\n      id: listingId ?? \"\",\n      unit,\n      pricePerUnit: String(pricePerUnit),\n      startDate,\n      endDate,\n      excludedDates: excludedDates.join(\",\"),\n      discounts: JSON.stringify(discounts),\n    }).toString();\n\n    router.push(`/add-venue/step-8-summary?${query}`);\n  }\n\n  const subtotal = effectiveUnits * pricePerUnit;\n  const discountAmount = computeDiscount(subtotal);\n  const afterDiscount = subtotal - discountAmount;\n  const commission = +(afterDiscount * 0.05).toFixed(2);\n  const serviceFee = +((afterDiscount + commission) * 0.01).toFixed(2);\n  const total = +(afterDiscount + commission + serviceFee).toFixed(2);\n\n  return (\n    <div className=\"min-h-screen p-6 bg-[radial-gradient(circle_at_top_left,#07102a_0%,#03031a_60%)] text-white\">\n      <div className=\"max-w-4xl mx-auto bg-[#07102a]/80 p-6 rounded-xl border border-zinc-800\">\n        <h2 className=\"text-2xl font-bold mb-4\">Booking & Availability</h2>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4\">\n          <label className=\"block\">\n            <div className=\"text-sm text-zinc-300\">Start date</div>\n            <input type=\"date\" value={startDate} onChange={(e)=>setStartDate(e.target.value)} className=\"mt-2 p-2 rounded bg-zinc-900\" />\n          </label>\n\n          <label className=\"block\">\n            <div className=\"text-sm text-zinc-300\">End date</div>\n            <input type=\"date\" value={endDate} onChange={(e)=>setEndDate(e.target.value)} className=\"mt-2 p-2 rounded bg-zinc-900\" />\n          </label>\n        </div>\n\n        <div className=\"mb-4\">\n          <label className=\"inline-flex items-center gap-2\">\n            <input type=\"checkbox\" checked={excludeMode} onChange={(e)=>setExcludeMode(e.target.checked)} />\n            <span className=\"text-sm text-zinc-300\">Exclude specific dates within range</span>\n          </label>\n        </div>\n\n        {/* Visual list of dates in range - click to toggle exclusion */}\n        <div className=\"mb-6\">\n          <div className=\"text-sm text-zinc-300 mb-2\">Selected dates</div>\n          <div className=\"flex flex-wrap gap-2\">\n            {dateRangeDays.map(d => {\n              const isExcluded = excludedDates.includes(d);\n              return (\n                <button\n                  key={d}\n                  disabled={!excludeMode}\n                  onClick={() => toggleExcluded(d)}\n                  className={`px-3 py-1 rounded-md ${isExcluded ? \"bg-red-600/80\" : \"bg-blue-600/80\"}`}\n                >\n                  {format(new Date(d), \"dd MMM\")}\n                </button>\n              );\n            })}\n          </div>\n        </div>\n\n        {/* Pricing */}\n        <div className=\"mb-6 grid grid-cols-1 md:grid-cols-3 gap-4\">\n          <div>\n            <label className=\"text-sm text-zinc-300\">Unit</label>\n            <select value={unit} onChange={(e)=>setUnit(e.target.value)} className=\"mt-2 p-2 rounded bg-zinc-900\">\n              <option value=\"night\">Per night</option>\n              <option value=\"hour\">Per hour</option>\n              <option value=\"gig\">Per gig</option>\n            </select>\n          </div>\n\n          <div>\n            <label className=\"text-sm text-zinc-300\">Price per {unit}</label>\n            <input type=\"number\" value={pricePerUnit} onChange={(e)=>{ setPricePerUnit(Number(e.target.value)); setPriceSlider(Number(e.target.value)); }} className=\"mt-2 p-2 rounded bg-zinc-900\" />\n          </div>\n\n          <div>\n            <label className=\"text-sm text-zinc-300\">Adjust price</label>\n            <input type=\"range\" min=\"0\" max=\"200000\" value={priceSlider} onChange={(e)=>{ setPriceSlider(Number(e.target.value)); setPricePerUnit(Number(e.target.value)); }} className=\"mt-3 w-full\" />\n            <div className=\"text-xs text-zinc-400 mt-1\">₹{pricePerUnit}</div>\n          </div>\n        </div>\n\n        {/* Discounts editor */}\n        <div className=\"mb-6\">\n          <h3 className=\"font-semibold mb-2\">Discounts</h3>\n          <div className=\"flex gap-2 items-center mb-2\">\n            <input type=\"number\" value={discUnits} onChange={(e)=>setDiscUnits(Number(e.target.value))} className=\"p-2 rounded bg-zinc-900\" />\n            <div className=\"text-zinc-300\">units →</div>\n            <input type=\"number\" value={discPercent} onChange={(e)=>setDiscPercent(Number(e.target.value))} className=\"p-2 rounded bg-zinc-900\" />\n            <div className=\"text-zinc-300\">%</div>\n            <button onClick={addDiscount} className=\"ml-2 px-3 py-1 bg-green-600 rounded\">Add</button>\n          </div>\n\n          <div className=\"bg-zinc-900 p-3 rounded\">\n            <table className=\"w-full text-sm\">\n              <thead className=\"text-zinc-400\">\n                <tr><th>Min units</th><th>Discount %</th></tr>\n              </thead>\n              <tbody>\n                {discounts.map((d,i)=>(\n                  <tr key={i}><td>{d.min_units}</td><td>{d.percent}%</td></tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        </div>\n\n        {/* Summary preview */}\n        <div className=\"mb-6 bg-[#021028] p-4 rounded\">\n          <div className=\"flex justify-between\"><div>Units</div><div>{effectiveUnits}</div></div>\n          <div className=\"flex justify-between\"><div>Subtotal</div><div>₹{subtotal.toFixed(2)}</div></div>\n          <div className=\"flex justify-between\"><div>Discount</div><div>- ₹{discountAmount.toFixed(2)}</div></div>\n          <div className=\"flex justify-between\"><div>Commission (5%)</div><div>₹{commission.toFixed(2)}</div></div>\n          <div className=\"flex justify-between\"><div>Service fee (1%)</div><div>₹{serviceFee.toFixed(2)}</div></div>\n          <div className=\"flex justify-between font-bold text-lg\"><div>Total</div><div>₹{total.toFixed(2)}</div></div>\n        </div>\n\n        <div className=\"flex gap-2\">\n          <button className=\"px-4 py-2 bg-blue-600 rounded-md\" onClick={handleNext}>Next: Summary</button>\n          <button className=\"px-4 py-2 bg-zinc-700 rounded-md\" onClick={()=>router.back()}>Back</button>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 737, "column": 0}, "map": {"version":3,"sources":["file:///Users/kartikarora/alt/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-dev-runtime.ts"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactJsxDevRuntime\n"],"names":["module","exports","require","vendored","ReactJsxDevRuntime"],"mappings":"AAAAA,OAAOC,OAAO,GACZC,QAAQ,gIACRC,QAAQ,CAAC,YAAY,CAAEC,kBAAkB","ignoreList":[0]}}]
}